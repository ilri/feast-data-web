ALTER TABLE `focus_group` ADD COLUMN `loc_json` LONGTEXT NULL DEFAULT NULL;
UPDATE `focus_group` SET `loc_json`=`geo_json` WHERE 1;
UPDATE `focus_group` SET `geo_json`= CONCAT('{"type": "Feature", "geometry": {"type": "Polygon", "coordinates":', loc_json, '}, "properties": {"id": ', id, '}}') WHERE 1;

select now() AS `export_time`,`focus_group`.`id_user` AS `user_id`,`focus_group`.`uploaded_at` AS `uploaded_at`,`focus_group`.`keep_private` AS `private`,`focus_group`.`exclude` AS `excluded`,`project`.`id` AS `project_id`,`getalias`(`project`.`id`,'project','title',`project`.`title`) AS `project_title`,`site`.`id` AS `site_id`,`getalias`(`site`.`id`,'site','name',`site`.`name`) AS `site_name`,`world_region`.`id` AS `site_world_region_id`,`world_region`.`name` AS `site_world_region_name`,`country`.`id` AS `site_country_id`,`country`.`name` AS `site_country`,`focus_group`.`id` AS `focus_group_id`,`focus_group`.`threshold_large_farm_ha` AS `focus_group_threshold_large_farm_ha`,`focus_group`.`threshold_small_farm_ha` AS `focus_group_threshold_small_farm_ha`,`focus_group`.`percent_households_landless` AS `focus_group_percent_households_landless`,`focus_group`.`percent_households_small` AS `focus_group_percent_households_small`,`focus_group`.`percent_households_medium` AS `focus_group_percent_households_medium`,`focus_group`.`percent_households_large` AS `focus_group_percent_households_large`,`focus_group`.`percent_credit_formal` AS `focus_group_percent_credit_formal`,`focus_group`.`percent_credit_informal` AS `focus_group_percent_credit_informal`,`focus_group`.`household_percent_migrating` AS `focus_group_household_percent_migrating`,`focus_group`.`percent_reproduction_bull` AS `focus_group_percent_reproduction_bull`,`focus_group`.`percent_reproduction_ai` AS `focus_group_percent_reproduction_ai`,`focus_group`.`percent_processing_female` AS `focus_group_percent_processing_female`,`focus_group`.`percent_processing_male` AS `focus_group_percent_processing_male`,`focus_group`.`percent_processing_overall` AS `focus_group_percent_processing_overall`,`focus_group`.`market_avg_distance_km` AS `focus_group_market_avg_distance_km`,`focus_group`.`market_avg_cost_travel` AS `focus_group_market_avg_cost_travel`,`focus_group`.`partner_organization` AS `focus_group_partner_organization`,`focus_group`.`venue_name` AS `focus_group_venue_name`,`focus_group`.`community_type` AS `focus_group_community_type`,`focus_group`.`community` AS `focus_group_community`,`focus_group`.`sub_region` AS `focu_group_sub_region`,((ifnull(`focus_group`.`gps_latitude_degrees`,0) + (ifnull(`focus_group`.`gps_latitude_minutes`,0) / 60)) + (ifnull(`focus_group`.`gps_latitude_seconds`,0) / 3600)) AS `focus_group_lat`,((ifnull(`focus_group`.`gps_longitude_degrees`,0) + (ifnull(`focus_group`.`gps_longitude_minutes`,0) / 60)) + (ifnull(`focus_group`.`gps_longitude_seconds`,0) / 3600)) AS `focus_group_lng`,(select ifnull(`sp`.`latitude`,0) from `spatial_data_site` `sp` where (`sp`.`id_site` = `site`.`id`) limit 1) AS `site_lat`,(select ifnull(`sp`.`longitude`,0) from `spatial_data_site` `sp` where (`sp`.`id_site` = `site`.`id`) limit 1) AS `site_lng`,`focus_group`.`loc_json` AS `loc_json`, `focus_group`.`geo_json` AS `geo_json` from ((((`focus_group` left join `site` on((`site`.`id` = `focus_group`.`id_site`))) left join `project` on((`project`.`id` = `site`.`id_project`))) left join `country` on((`country`.`id` = `site`.`id_country`))) left join `world_region` on((`world_region`.`id` = `country`.`id_world_region`)))